<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="cn.yfyue.lxc.db.inter.TLxcPackageDiscountMapper" >
  <resultMap id="BaseResultMap" type="cn.yfyue.lxc.db.model.TLxcPackageDiscount" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="id" property="id" jdbcType="INTEGER" />
    <result column="dname" property="dname" jdbcType="VARCHAR" />
    <result column="remove" property="remove" jdbcType="BIT" />
    <result column="create_time" property="createTime" jdbcType="TIMESTAMP" />
    <result column="update_time" property="updateTime" jdbcType="TIMESTAMP" />
    <result column="recharge_money" property="rechargeMoney" jdbcType="REAL" />
    <result column="giving_money" property="givingMoney" jdbcType="REAL" />
    <result column="packge_discount_start" property="packgeDiscountStart" jdbcType="TIMESTAMP" />
    <result column="packge_discount_end" property="packgeDiscountEnd" jdbcType="TIMESTAMP" />
    <result column="package_use_start" property="packageUseStart" jdbcType="TIMESTAMP" />
    <result column="package_use_end" property="packageUseEnd" jdbcType="TIMESTAMP" />
    <result column="note" property="note" jdbcType="VARCHAR" />
  </resultMap>
  
  <!-- 查询所有套餐 -->
  <select id="getDiscountList" resultMap="BaseResultMap">
    SELECT id,dname,remove,create_time,update_time,recharge_money,giving_money,packge_discount_start,
    packge_discount_end,package_use_start,package_use_end,note FROM (
     SELECT id,dname,remove,create_time,update_time,recharge_money,giving_money,packge_discount_start,
    packge_discount_end,package_use_start,package_use_end,note
		FROM t_lxc_package_discount
		 WHERE 1=1 
		 <if test="qkey !=null">
		 	AND dname LIKE '%${qkey}%'
		 </if>
              ORDER BY create_time DESC
         ) as Q1  LIMIT #{startRow,jdbcType=INTEGER},#{rownum,jdbcType=INTEGER}
  </select> 
   
  <select id="getDiscountListUnremove" resultMap="BaseResultMap">
    SELECT id,dname,remove,create_time,update_time,recharge_money,giving_money,packge_discount_start,
    packge_discount_end,package_use_start,package_use_end,note FROM (
     SELECT id,dname,remove,create_time,update_time,recharge_money,giving_money,packge_discount_start,
    packge_discount_end,package_use_start,package_use_end,note
		FROM t_lxc_package_discount
		 WHERE 1=1 and remove=0
		 <if test="qkey !=null">
		 	AND dname LIKE '%${qkey}%'
		 </if>
              ORDER BY create_time DESC
         ) as Q1  LIMIT #{startRow,jdbcType=INTEGER},#{rownum,jdbcType=INTEGER}
  </select>  
<!--统计套餐条数-->  
 <select id="getDiscountListCount" resultType="java.lang.Integer">
    SELECT COUNT(1) FROM t_lxc_package_discount
		 WHERE 1=1 
		 <if test="qkey !=null">
		    AND dname LIKE '%${qkey}%'
		 </if>
 </select>
 <!-- 删除套餐    有外键，暂时不写 -->	
 <delete id="delDiscountById">
 	DELETE FROM t_lxc_package_discount WHERE ID=#{id,jdbcType=INTEGER}
 </delete>
  <!--取自己的套餐数据 -->
 <select id="getMyDiscount" resultMap="BaseResultMap">
SELECT id,dname,remove,create_time,update_time,recharge_money,giving_money,packge_discount_start,
    packge_discount_end,package_use_start,package_use_end,note FROM t_lxc_package_discount WHERE ID=#{id,jdbcType=INTEGER}
 </select>
 <!-- 更新套餐 -->
 <update id="upDiscountDate" parameterType="cn.yfyue.lxc.db.model.TLxcPackageDiscount" >
    UPDATE t_lxc_package_discount
     <set>
	      <if test="id !=null">
	    	id=#{id,jdbcType=INTEGER},
	      </if>
	      <if test="dname != null" >
	        dname = #{dname,jdbcType=VARCHAR},
	      </if>
	      <if test="remove != null" >
	        remove = #{remove,jdbcType=BIT},
	      </if>
	      <if test="rechargeMoney != null" >
	        recharge_money = #{rechargeMoney,jdbcType=REAL},
	      </if>
	      <if test="givingMoney != null" >
	        giving_money = #{givingMoney,jdbcType=REAL},
	      </if>
	      <if test="packgeDiscountStart != null" >
	        packge_discount_start = #{packgeDiscountStart,jdbcType=TIMESTAMP},
	      </if>
	      <if test="packgeDiscountEnd != null" >
	        packge_discount_end = #{packgeDiscountEnd,jdbcType=TIMESTAMP},
	      </if>
	      <if test="packageUseStart != null" >
	        package_use_start = #{packageUseStart,jdbcType=TIMESTAMP},
	      </if>
	      <if test="packageUseEnd != null" >
	        package_use_end = #{packageUseEnd,jdbcType=TIMESTAMP},
	      </if>
	      <if test="note !=null">
	  		note=#{note,jdbcType=VARCHAR},
	      </if>
     </set>
    	WHERE id=#{id,jdbcType=INTEGER}
  </update>
 <!-- 添加套餐 -->
 <insert id="addDiscount" parameterType="cn.yfyue.lxc.db.model.TLxcPackageDiscount">
 	INSERT INTO t_lxc_package_discount(dname,remove,create_time,update_time,recharge_money,giving_money,packge_discount_start,
 	packge_discount_end,package_use_start,package_use_end,note)
    VALUES(#{dname,jdbcType=VARCHAR},#{remove,jdbcType=BIT},#{createTime,jdbcType=TIMESTAMP},
    #{updateTime,jdbcType=TIMESTAMP},#{rechargeMoney,jdbcType=REAL},#{givingMoney,jdbcType=REAL},
    #{packgeDiscountStart,jdbcType=TIMESTAMP},#{packgeDiscountEnd,jdbcType=TIMESTAMP},#{packageUseStart,jdbcType=TIMESTAMP},
    #{packageUseEnd,jdbcType=TIMESTAMP},#{note,jdbcType=VARCHAR})
 </insert>
 <!--禁用套餐--> 
 <update id="disCountmanage">
    UPDATE t_lxc_package_discount SET remove=0 WHERE ID=#{id,jdbcType=INTEGER}
</update>
<!-- 启用套餐 -->
<update id="startDisount">
    UPDATE t_lxc_package_discount SET remove=1 WHERE ID=#{id,jdbcType=INTEGER}
</update>
</mapper>