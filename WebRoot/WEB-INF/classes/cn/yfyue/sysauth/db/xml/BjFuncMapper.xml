<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="cn.yfyue.sysauth.db.inter.BjFuncMapper" >
  <resultMap id="BaseResultMap" type="cn.yfyue.sysauth.db.model.BjFunc" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="FUNC_ID" property="funcId" jdbcType="BIGINT" />
    <result column="FUNC_NAME" property="funcName" jdbcType="CHAR" />
    <result column="FUNC_URL" property="funcUrl" jdbcType="VARCHAR" />
    <result column="FUNC_STATE" property="funcState" jdbcType="INTEGER" />
    <result column="SUPPER_FUNC_ID" property="supperFuncId" jdbcType="BIGINT" />
    <result column="IS_LEAF" property="isLeaf" jdbcType="INTEGER" />
    <result column="FUNC_ALIAS" property="funcAlias" jdbcType="CHAR" />
    <result column="FUNC_LEVEL" property="funcLevel" jdbcType="INTEGER" />
    <result column="STYLE_IMG" property="styleImg" jdbcType="VARCHAR" />
    <result column="FUNC_ORDER" property="funcOrder" jdbcType="BIGINT" />
    <result column="REG_MAN" property="regMan" jdbcType="BIGINT" />
    <result column="REG_TIME" property="regTime" jdbcType="TIMESTAMP" />
  </resultMap>
 <!-- 
	 //取所有功能
	List<BjFunc> getFuncAllList(); 
  --> 
<select id="getFuncAllList"   resultMap="BaseResultMap">
  SELECT  FUNC_ID,FUNC_NAME,FUNC_URL,
	  FUNC_STATE,SUPPER_FUNC_ID,IS_LEAF,
	  FUNC_ALIAS,FUNC_LEVEL,FUNC_ORDER
	FROM BJ_FUNC ORDER BY FUNC_ORDER DESC
</select>
<!-- 
//添加
int addFunc(BjFunc bjFunc);
-->
 <insert id="addFunc" parameterType="cn.yfyue.sysauth.db.model.BjFunc" >
    insert into BJ_FUNC (FUNC_NAME, FUNC_URL, 
      FUNC_STATE, SUPPER_FUNC_ID, IS_LEAF, 
      FUNC_ALIAS, FUNC_LEVEL, STYLE_IMG, 
      FUNC_ORDER, REG_MAN, REG_TIME
      )
    values ( #{funcName,jdbcType=CHAR}, #{funcUrl,jdbcType=VARCHAR}, 
      0, #{supperFuncId,jdbcType=BIGINT}, #{isLeaf,jdbcType=INTEGER}, 
      #{funcAlias,jdbcType=CHAR}, #{funcLevel,jdbcType=INTEGER}, #{styleImg,jdbcType=VARCHAR}, 
      #{funcOrder,jdbcType=BIGINT}, #{regMan,jdbcType=BIGINT}, NOW()
      )
  </insert>
<!--
//获取单个
BjFunc getFuncInfo(String funcId);
-->
<select id="getFuncInfo"   resultMap="BaseResultMap">
  SELECT FUNC_ID,FUNC_NAME,FUNC_URL,IS_LEAF,FUNC_ALIAS,STYLE_IMG,FUNC_ORDER,FUNC_LEVEL
    FROM BJ_FUNC WHERE FUNC_ID=#{funcId,jdbcType=BIGINT} LIMIT 1
</select>
<!--
//更新
int upFunc(BjFunc bjFunc);
-->
 <update id="upFunc" parameterType="cn.yfyue.sysauth.db.model.BjFunc" >
    update BJ_FUNC
    <set >
      <if test="funcName != null" >
        FUNC_NAME = #{funcName,jdbcType=CHAR},
      </if>
      <if test="funcUrl != null" >
        FUNC_URL = #{funcUrl,jdbcType=VARCHAR},
      </if>
      <if test="isLeaf != null" >
        IS_LEAF = #{isLeaf,jdbcType=INTEGER},
      </if>
      <if test="funcAlias != null" >
        FUNC_ALIAS = #{funcAlias,jdbcType=CHAR},
      </if>
        STYLE_IMG = #{styleImg,jdbcType=VARCHAR},
      <if test="funcOrder != null" >
        FUNC_ORDER = #{funcOrder,jdbcType=BIGINT},
      </if>
      <if test="regMan != null" >
        REG_MAN = #{regMan,jdbcType=BIGINT},
      </if>
        REG_TIME =NOW(),
    </set>
    where FUNC_ID = #{funcId,jdbcType=BIGINT}
  </update>
<!--
//删除
int delFunc(String funcId);
-->
<delete id="delFunc">
  DELETE FROM BJ_FUNC WHERE FUNC_ID=#{funcId,jdbcType=BIGINT}
</delete>
<!--
//是否有子节点
int getFuncIsChild(String funcId); 
 -->
<select id="getFuncIsChild"   resultType="java.lang.Integer">
   SELECT COUNT(1) FROM BJ_FUNC WHERE SUPPER_FUNC_ID=#{funcId,jdbcType=BIGINT}
</select>
    


</mapper>