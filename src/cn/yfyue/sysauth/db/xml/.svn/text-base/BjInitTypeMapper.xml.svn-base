<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="cn.yfyue.sysauth.db.inter.BjInitTypeMapper" >
  <resultMap id="BaseResultMap" type="cn.yfyue.sysauth.db.model.BjInitType" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="INIT_TYPE_ID" property="initTypeId" jdbcType="BIGINT" />
    <result column="TYPE_NAME" property="typeName" jdbcType="VARCHAR" />
    <result column="TYPE_CODE" property="typeCode" jdbcType="CHAR" />
    <result column="LOG_TIME" property="logTime" jdbcType="TIMESTAMP" />
    <result column="TYPE_STATE" property="typeState" jdbcType="INTEGER" />
  </resultMap>
 <!-- 
 //配置类型列表
List<BjInitType> getInitTypeList(@Param("qkey")String qkey,@Param("startRow")int startRow,
@Param("rowNum")int rowNum);
-->
<select id="getInitTypeList"   resultMap="BaseResultMap">
    SELECT INIT_TYPE_ID,TYPE_NAME,TYPE_CODE,TYPE_CODE,LOG_TIME FROM (
       SELECT  INIT_TYPE_ID, TYPE_NAME, TYPE_CODE, LOG_TIME 
		FROM BJ_INIT_TYPE WHERE 1=1 
                <if test="qkey !=null">
                	AND TYPE_NAME LIKE '%${qkey}%'
				</if>
              ORDER BY LOG_TIME DESC
         ) as Q1  LIMIT #{startRow,jdbcType=INTEGER},#{rowNum,jdbcType=INTEGER}
  </select>  
<!--
//配置类型统计
int getInitTypeCount(@Param("qkey")String qkey);
  --> 
 <select id="getInitTypeCount"   resultType="java.lang.Integer">
      SELECT COUNT(1) FROM BJ_INIT_TYPE WHERE 1=1 
         <if test="qkey !=null">
              AND TYPE_NAME LIKE '%${qkey}%'
		</if>
              ORDER BY LOG_TIME DESC
 </select> 
<!-- 
//添加类型
int addInitType(BjInitType bjInitType);
-->
  <insert id="addInitType" parameterType="cn.yfyue.sysauth.db.model.BjInitType" >
     insert into BJ_INIT_TYPE (TYPE_NAME, TYPE_CODE, LOG_TIME,TYPE_STATE)
       values (#{typeName,jdbcType=VARCHAR}, #{typeCode,jdbcType=CHAR}, 
       NOW(),0)
  </insert>
<!--
//取单个类型
BjInitType getInitTypeInfo(String initTypeId);
-->
<select id="getInitTypeInfo"   resultMap="BaseResultMap">
    SELECT  INIT_TYPE_ID, TYPE_NAME, TYPE_CODE, TYPE_STATE, LOG_TIME 
	 FROM BJ_INIT_TYPE WHERE INIT_TYPE_ID=#{initTypeId,jdbcType=BIGINT}
  </select>  
<!--
//更新
int upInitType(BjInitType bjInitType);
-->
  <update id="upInitType" parameterType="cn.yfyue.sysauth.db.model.BjInitType" >
    update BJ_INIT_TYPE
    <set >
      <if test="typeName != null" >
        TYPE_NAME = #{typeName,jdbcType=VARCHAR},
      </if>
        LOG_TIME = NOW(),
    </set>
    where INIT_TYPE_ID = #{initTypeId,jdbcType=BIGINT}
  </update>
<!--
//删除
int delInitType(String initTypeId);
-->
<delete id="delInitType">
   DELETE FROM BJ_INIT_TYPE WHERE INIT_TYPE_ID = #{initTypeId,jdbcType=BIGINT}
</delete>
<!--
//验证是否有下级数据
int getInitTypeIsChild(String typeCode);
 --> 
 <select id="getInitTypeIsChild"   resultType="java.lang.Integer">
   SELECT COUNT(1) FROM BJ_INIT_DATA WHERE TYPE_CODE=#{typeCode,jdbcType=CHAR}
 </select>
 <!-- 
 //验证编码是否存在
int isInitTypeCode(String initTypeCode);
  -->
 <select id="isInitTypeCode"   resultType="java.lang.Integer">
   SELECT COUNT(1) FROM BJ_INIT_TYPE WHERE TYPE_CODE=#{initTypeCode,jdbcType=CHAR}
 </select>
</mapper>