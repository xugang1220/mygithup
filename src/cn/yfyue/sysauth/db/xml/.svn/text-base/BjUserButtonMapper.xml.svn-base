<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="cn.yfyue.sysauth.db.inter.BjUserButtonMapper" >
  <resultMap id="BaseResultMap" type="cn.yfyue.sysauth.db.model.BjUserButton" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="USER_BUTTON_ID" property="userButtonId" jdbcType="BIGINT" />
    <result column="FUN_ID" property="funId" jdbcType="BIGINT" />
    <result column="BUTTON_ID" property="buttonId" jdbcType="BIGINT" />
    <result column="USER_ID" property="userId" jdbcType="BIGINT" />
    <result column="LOG_TIME" property="logTime" jdbcType="TIMESTAMP" />

    <result column="BUTTON_HTML" property="buttonHtml" jdbcType="VARCHAR" />
    <result column="BUTTON_NAME" property="buttonName" jdbcType="CHAR" />

  </resultMap>
<!-- 
//按功能ID和用户取按钮
List<BjUserButton> getUserIdAndFuncIdButtonList(@Param("userId")String userId,
		@Param("funcId")String funcId,@Param("adminLevel")String adminLevel);
 -->  
 <select id="getUserIdAndFuncIdButtonList"   resultMap="BaseResultMap">
	<choose>
	  <when test="adminLevel ==0">
	    SELECT BUTTON_ID,FUN_ID,BUTTON_HTML,BUTTON_NAME
	    	FROM BJ_BUTTON ORDER BY BUTTON_ID ASC
	  </when>
	  <otherwise>
	    SELECT b.BUTTON_ID,b.FUN_ID,b.BUTTON_HTML,b.BUTTON_NAME
	      FROM BJ_USER_BUTTON a,BJ_BUTTON b WHERE a.BUTTON_ID=b.BUTTON_ID 
	       AND a.USER_ID=#{userId,jdbcType=BIGINT} AND a.FUN_ID=#{funcId,jdbcType=BIGINT}
	      ORDER BY b.BUTTON_ID ASC
	  </otherwise>
	</choose>
</select>
 <!-- 
 //取自己的按钮
List<BjUserButton> getUserButtonList(@Param("userId")String userId,
		@Param("adminLevel")String adminLevel);
-->
<select id="getUserButtonList"   resultMap="BaseResultMap">
	<choose>
	  <when test="adminLevel ==0">
	    SELECT BUTTON_ID,FUN_ID,BUTTON_HTML,BUTTON_NAME
	    	FROM BJ_BUTTON ORDER BY BUTTON_ID ASC
	  </when>
	  <otherwise>
	    SELECT b.BUTTON_ID,b.FUN_ID,b.BUTTON_HTML,b.BUTTON_NAME
	      FROM BJ_USER_BUTTON a,BJ_BUTTON b WHERE a.BUTTON_ID=b.BUTTON_ID 
	       AND a.USER_ID=#{userId,jdbcType=BIGINT}
	      ORDER BY b.BUTTON_ID ASC
	  </otherwise>
	</choose>
</select>
<!-- 
//添加分配按钮
int addUserButton(BjUserButton bjUserButton);
-->
  <insert id="addUserButton" parameterType="cn.yfyue.sysauth.db.model.BjUserButton" >
    insert into BJ_USER_BUTTON ( FUN_ID, BUTTON_ID, 
      USER_ID, LOG_TIME)
    values ( #{funId,jdbcType=BIGINT}, #{buttonId,jdbcType=BIGINT}, 
      #{userId,jdbcType=BIGINT},NOW())
  </insert>
<!-- 	
 
//按功能ID清掉
int delFunIdToUserButton(String funcId);
-->
<delete id="delFunIdToUserButton">
  DELETE FROM BJ_USER_BUTTON WHERE FUN_ID=#{funcId,jdbcType=BIGINT}
</delete>
<!-- 
//按按钮ID清掉
int delButtonIdToUserButton(String buttonId);
-->
<delete id="delButtonIdToUserButton">
  DELETE FROM BJ_USER_BUTTON WHERE BUTTON_ID=#{buttonId,jdbcType=BIGINT}
</delete>
<!-- 
//按用户清掉	
int delUserIdToUserButton(String userId);
 -->	
<delete id="delUserIdToUserButton">
  DELETE FROM BJ_USER_BUTTON WHERE USER_ID=#{userId,jdbcType=BIGINT}
</delete>

  
</mapper>