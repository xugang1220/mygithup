<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="cn.yfyue.sysauth.db.inter.BjUserAreaMapper" >
  <resultMap id="BaseResultMap" type="cn.yfyue.sysauth.db.model.BjUserArea" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="AREA_ID" property="areaId" jdbcType="BIGINT" />
    <result column="USER_ID" property="userId" jdbcType="BIGINT" />
    <result column="AREA_CODE" property="areaCode" jdbcType="CHAR" />
    <result column="REG_MAN" property="regMan" jdbcType="BIGINT" />
    <result column="REG_TIME" property="regTime" jdbcType="TIMESTAMP" />
    
    <result column="AREA_LEVEL" property="areaLevel" jdbcType="INTEGER" />
    <result column="SUPPER_CODE" property="supperCode" jdbcType="CHAR" />
    <result column="AREA_NAME" property="areaName" jdbcType="CHAR" />
    <result column="FULL_NAME" property="fullName" jdbcType="VARCHAR" />    
  </resultMap>
  
<!-- 
//取用户的地区
List<BjUserArea> getUserAreaList(@Param("userId")String userId,
		@Param("adminLevel")String adminLevel);
-->
<select id="getUserAreaList"   resultMap="BaseResultMap">
     <choose>
         <when test="adminLevel ==0">
				SELECT  AREA_CODE,AREA_LEVEL,SUPPER_CODE,
				  AREA_NAME,FULL_NAME 
				FROM BJ_AREA 
         </when>
         <otherwise>
			SELECT b.AREA_CODE,b.AREA_LEVEL,b.SUPPER_CODE,
			  b.AREA_NAME,b.FULL_NAME FROM BJ_USER_AREA a,BJ_AREA b 
			 WHERE a.AREA_CODE=b.AREA_CODE AND a.USER_ID=#{userId,jdbcType=BIGINT}
        </otherwise>
     </choose>
</select>
<!-- 		
//添加分配权限
int addUserArea(BjUserArea bjUserArea);
-->
<insert id="addUserArea" parameterType="cn.yfyue.sysauth.db.model.BjUserArea" >
    insert into BJ_USER_AREA (USER_ID, AREA_CODE, 
      REG_MAN, REG_TIME)
    values (#{userId,jdbcType=BIGINT}, #{areaCode,jdbcType=CHAR}, 
      #{regMan,jdbcType=BIGINT}, NOW())
 </insert>
<!-- 		
//按地区编码清掉权限
int delAreaCodeToUserArea(String areaCode);
-->
<delete id="delAreaCodeToUserArea">
  DELETE FROM BJ_USER_AREA WHERE AREA_CODE=#{areaCode,jdbcType=CHAR}
</delete>
<!-- 		
//按用户ID清掉权限
int delUserIdToUserArea(String userId);
 -->  
<delete id="delUserIdToUserArea">
   DELETE FROM BJ_USER_AREA WHERE USER_ID=#{userId,jdbcType=BIGINT}
</delete>  

</mapper>